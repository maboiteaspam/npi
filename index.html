<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Npi by maboiteaspam</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Npi</h1>
        <p>node project init</p>

        <p class="view"><a href="https://github.com/maboiteaspam/npi">View the Project on GitHub <small>maboiteaspam/npi</small></a></p>


        <ul>
          <li><a href="https://github.com/maboiteaspam/npi/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/maboiteaspam/npi/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/maboiteaspam/npi">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="npi" class="anchor" href="#npi" aria-hidden="true"><span class="octicon octicon-link"></span></a>npi</h1>

<p>Node Project Init</p>

<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<pre><code>npm i maboiteaspam/npi -g
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<pre><code>npi [--verbose|-v] [-- module1 module2]
npi [module1 module2]
</code></pre>

<h2>
<a id="flow" class="anchor" href="#flow" aria-hidden="true"><span class="octicon octicon-link"></span></a>Flow</h2>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> ignored <span class="pl-k">=</span> [
  <span class="pl-s"><span class="pl-pds">'</span>node_modules/<span class="pl-pds">'</span></span>,
  <span class="pl-s"><span class="pl-pds">'</span>npm-debug.log<span class="pl-pds">'</span></span>
];

<span class="pl-k">var</span> templateVars <span class="pl-k">=</span> {
  name        <span class="pl-k">:</span> <span class="pl-smi">path</span>.<span class="pl-en">basename</span>(<span class="pl-smi">process</span>.<span class="pl-en">cwd</span>()),
  description <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Description of the module.<span class="pl-pds">"</span></span>,
  ignored     <span class="pl-k">:</span> ignored,
  modules     <span class="pl-k">:</span> argv[<span class="pl-s"><span class="pl-pds">'</span>_<span class="pl-pds">'</span></span>]
};

npi
  <span class="pl-c">// npm init</span>
  .<span class="pl-en">pipe</span>(<span class="pl-en">spawn</span>(<span class="pl-s"><span class="pl-pds">'</span>npm<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>init<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>--yes<span class="pl-pds">'</span></span>],
    {stdio<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>inherit<span class="pl-pds">'</span></span>}))
  .<span class="pl-en">pipe</span>(<span class="pl-en">bubble</span>(<span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>,
    {message<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>file<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>body<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>package.json<span class="pl-pds">'</span></span>}))

  <span class="pl-c">// gather user input</span>
  .<span class="pl-en">pipe</span>(<span class="pl-en">input</span>(<span class="pl-s"><span class="pl-pds">'</span>Input the module<span class="pl-cce">\'</span>s description :<span class="pl-pds">'</span></span>,
    templateVars, <span class="pl-s"><span class="pl-pds">'</span>description<span class="pl-pds">'</span></span>))
  .<span class="pl-en">pipe</span>(<span class="pl-en">input</span>(<span class="pl-s"><span class="pl-pds">'</span>Input the module<span class="pl-cce">\'</span>s keywords :<span class="pl-pds">'</span></span>,
    templateVars, <span class="pl-s"><span class="pl-pds">'</span>keywords<span class="pl-pds">'</span></span>))
  .<span class="pl-en">pipe</span>(<span class="pl-en">choose</span>(<span class="pl-s"><span class="pl-pds">'</span>Please choose a licence :<span class="pl-pds">'</span></span>,
    templateVars, <span class="pl-s"><span class="pl-pds">'</span>licence<span class="pl-pds">'</span></span>))
  .<span class="pl-en">pipe</span>( <span class="pl-k">!</span>argv[<span class="pl-s"><span class="pl-pds">'</span>_<span class="pl-pds">'</span></span>].<span class="pl-c1">length</span>
    <span class="pl-k">?</span> <span class="pl-en">input</span>(<span class="pl-s"><span class="pl-pds">'</span>Input the module<span class="pl-cce">\'</span>s dependencies :<span class="pl-pds">'</span></span>,
    templateVars, <span class="pl-s"><span class="pl-pds">'</span>dependencies<span class="pl-pds">'</span></span>)
    <span class="pl-k">:</span> <span class="pl-en">streamMsger</span>(<span class="pl-s"><span class="pl-pds">'</span>skip<span class="pl-pds">'</span></span>) )
  .<span class="pl-en">pipe</span>(<span class="pl-en">input</span>(<span class="pl-s"><span class="pl-pds">'</span>Input the module<span class="pl-cce">\'</span>s devDep<span class="pl-cce">\'</span>s :<span class="pl-pds">'</span></span>,
    templateVars, <span class="pl-s"><span class="pl-pds">'</span>devDependencies<span class="pl-pds">'</span></span>))

   <span class="pl-c">//generate templates</span>
  .<span class="pl-en">pipe</span>(<span class="pl-en">genTemplate</span>(tplPath, <span class="pl-s"><span class="pl-pds">'</span>README.md<span class="pl-pds">'</span></span>    , templateVars))
  .<span class="pl-en">pipe</span>(<span class="pl-en">genTemplate</span>(tplPath, <span class="pl-s"><span class="pl-pds">'</span>playground.js<span class="pl-pds">'</span></span>, templateVars))
  .<span class="pl-en">pipe</span>(<span class="pl-en">genTemplate</span>(tplPath, <span class="pl-s"><span class="pl-pds">'</span>index.js<span class="pl-pds">'</span></span>     , templateVars))
  .<span class="pl-en">pipe</span>(<span class="pl-en">genTemplate</span>(tplPath, <span class="pl-s"><span class="pl-pds">'</span>.gitignore<span class="pl-pds">'</span></span>   , templateVars))

  <span class="pl-c">// npm module install</span>
  .<span class="pl-en">pipe</span>(<span class="pl-en">spawn</span>(<span class="pl-s"><span class="pl-pds">'</span>npm<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (){
    <span class="pl-k">var</span> modules <span class="pl-k">=</span> <span class="pl-smi">templateVars</span>.<span class="pl-smi">dependencies</span>
      .<span class="pl-c1">replace</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-k">^</span><span class="pl-c1">\s</span><span class="pl-k">+</span><span class="pl-pds">/</span></span>, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>).<span class="pl-c1">replace</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-c1">\s</span><span class="pl-k">+</span><span class="pl-k">$</span><span class="pl-pds">/</span></span>, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>).<span class="pl-c1">split</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-c1">\s</span><span class="pl-pds">/</span></span>);
    <span class="pl-k">if</span> (<span class="pl-k">!</span><span class="pl-smi">modules</span>.<span class="pl-c1">length</span> <span class="pl-k">||</span> <span class="pl-k">!</span>modules[<span class="pl-c1">0</span>].<span class="pl-c1">length</span>) <span class="pl-k">return</span> <span class="pl-c1">false</span>;
    <span class="pl-k">return</span> [<span class="pl-s"><span class="pl-pds">'</span>i<span class="pl-pds">'</span></span>].<span class="pl-c1">concat</span>(modules).<span class="pl-c1">concat</span>(<span class="pl-s"><span class="pl-pds">'</span>--save<span class="pl-pds">'</span></span>);
  }, {stdio<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>inherit<span class="pl-pds">'</span></span>}))
  .<span class="pl-en">pipe</span>(<span class="pl-en">spawn</span>(<span class="pl-s"><span class="pl-pds">'</span>npm<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (){
    <span class="pl-k">var</span> modules <span class="pl-k">=</span> <span class="pl-smi">templateVars</span>.<span class="pl-smi">devDependencies</span>
      .<span class="pl-c1">replace</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-k">^</span><span class="pl-c1">\s</span><span class="pl-k">+</span><span class="pl-pds">/</span></span>, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>).<span class="pl-c1">replace</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-c1">\s</span><span class="pl-k">+</span><span class="pl-k">$</span><span class="pl-pds">/</span></span>, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>).<span class="pl-c1">split</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-c1">\s</span><span class="pl-pds">/</span></span>);
    <span class="pl-k">if</span> (<span class="pl-k">!</span><span class="pl-smi">modules</span>.<span class="pl-c1">length</span> <span class="pl-k">||</span> <span class="pl-k">!</span>modules[<span class="pl-c1">0</span>].<span class="pl-c1">length</span>) <span class="pl-k">return</span> <span class="pl-c1">false</span>;
    <span class="pl-k">return</span> [<span class="pl-s"><span class="pl-pds">'</span>i<span class="pl-pds">'</span></span>].<span class="pl-c1">concat</span>(modules).<span class="pl-c1">concat</span>(<span class="pl-s"><span class="pl-pds">'</span>--save-dev<span class="pl-pds">'</span></span>);
  }, {stdio<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>inherit<span class="pl-pds">'</span></span>}))

  <span class="pl-c">// fix package.json file</span>
  .<span class="pl-en">pipe</span>(<span class="pl-en">updatePkg</span>(<span class="pl-s"><span class="pl-pds">'</span>package.json<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> () {
    <span class="pl-k">return</span> {
      licence         <span class="pl-k">:</span> <span class="pl-smi">templateVars</span>.<span class="pl-smi">licence</span>,
      description     <span class="pl-k">:</span> <span class="pl-smi">templateVars</span>.<span class="pl-c1">description</span>,
      keywords        <span class="pl-k">:</span> <span class="pl-smi">templateVars</span>.<span class="pl-smi">keywords</span>.<span class="pl-c1">split</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-c1">\s</span><span class="pl-pds">/</span></span>)
    };
  }))

  <span class="pl-c">// git init, add, commit</span>
  .<span class="pl-en">pipe</span>(<span class="pl-en">spawn</span>(<span class="pl-s"><span class="pl-pds">'</span>git<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>init<span class="pl-pds">'</span></span>],
    {stdio<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>inherit<span class="pl-pds">'</span></span>}))
  .<span class="pl-en">pipe</span>(<span class="pl-en">spawn</span>(<span class="pl-s"><span class="pl-pds">'</span>git<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (){
    <span class="pl-k">return</span> [<span class="pl-s"><span class="pl-pds">'</span>add<span class="pl-pds">'</span></span>].<span class="pl-c1">concat</span>(files)
  }, {stdio<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>inherit<span class="pl-pds">'</span></span>}))
  .<span class="pl-en">pipe</span>(<span class="pl-en">spawn</span>(<span class="pl-s"><span class="pl-pds">'</span>git<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>commit<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>-m<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>npi:<span class="pl-pds">'</span></span><span class="pl-k">+</span><span class="pl-smi">pkg</span>.<span class="pl-c1">version</span>],
    {stdio<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>inherit<span class="pl-pds">'</span></span>}))
;</pre></div>

<h2>
<a id="pipe" class="anchor" href="#pipe" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pipe</h2>

<p>I don t know if that helps :D</p>

<div class="highlight highlight-source-js"><pre>        <span class="pl-c1">process</span>
<span class="pl-k">-</span>▶<span class="pl-k">-</span>stdin<span class="pl-k">-</span>▶<span class="pl-k">|</span>
          <span class="pl-k">|</span> <span class="pl-k">var</span> npi <span class="pl-k">=</span> <span class="pl-en">stream</span>()
          <span class="pl-k">|</span>    .<span class="pl-en">pipe</span>() ▼
          <span class="pl-k">|</span>          route <span class="pl-s"><span class="pl-pds">'</span>npi<span class="pl-pds">'</span></span> msg <span class="pl-k">-</span>▼
          <span class="pl-k">|</span> npi◀<span class="pl-k">-</span><span class="pl-k">|</span>                    <span class="pl-k">|</span>
          <span class="pl-k">|</span>  <span class="pl-k">|</span>   ▲                    <span class="pl-k">|</span>
          <span class="pl-k">|</span>  <span class="pl-k">|</span>   <span class="pl-k">|</span>◀<span class="pl-k">-</span>fnT1 bubble◀<span class="pl-k">-</span><span class="pl-k">|</span>    <span class="pl-k">|</span><span class="pl-k">-</span>▶<span class="pl-en">fnT1</span> (spawn npm)
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                   <span class="pl-k">|</span>    <span class="pl-k">|</span>   ▼
          <span class="pl-k">|</span>  ▼                   ▲    <span class="pl-k">|</span><span class="pl-k">-</span>▶fnT2<span class="pl-k">--</span><span class="pl-k">-</span>▶bubble <span class="pl-c1">event</span><span class="pl-k">-</span>▶<span class="pl-k">|</span>
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                   <span class="pl-k">|</span>    <span class="pl-k">|</span>   ▼                    ▼
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                   <span class="pl-k">|</span>    <span class="pl-k">|</span>   <span class="pl-k">-</span>    <span class="pl-c1">event</span>{ type<span class="pl-k">:</span> message
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                   <span class="pl-k">|</span>    <span class="pl-k">|</span>   <span class="pl-k">-</span>           body<span class="pl-k">:</span> some   }
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                   <span class="pl-k">|</span>    <span class="pl-k">|</span>   <span class="pl-k">-</span>                    ▼
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                   <span class="pl-k">|</span>◀<span class="pl-k">--------------------------</span>◀<span class="pl-k">-</span><span class="pl-k">|</span>
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                        <span class="pl-k">|</span>   <span class="pl-k">-</span>
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                        <span class="pl-k">|</span>   ▼
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                        <span class="pl-k">|</span><span class="pl-k">-</span>▶fnT3
          <span class="pl-k">|</span>  <span class="pl-k">|</span>                        (end <span class="pl-k">of</span> npi)
          <span class="pl-k">|</span>  <span class="pl-k">|</span>
          <span class="pl-k">|</span>  ▼
          <span class="pl-k">|</span> <span class="pl-k">var</span> msgListener <span class="pl-k">=</span> <span class="pl-en">eventStream</span>(<span class="pl-s"><span class="pl-pds">'</span>message<span class="pl-pds">'</span></span>, npi);
          <span class="pl-k">|</span>    .<span class="pl-en">pipe</span>() ▼
          <span class="pl-k">|</span>         route <span class="pl-s"><span class="pl-pds">'</span>file<span class="pl-pds">'</span></span> msg <span class="pl-k">-</span>▼
          <span class="pl-k">|</span>                           <span class="pl-k">|</span><span class="pl-k">-</span>▶<span class="pl-en">fnT1</span> (extract body)
          <span class="pl-k">|</span>                           <span class="pl-k">|</span>   ▼
          <span class="pl-k">|</span>                           <span class="pl-k">|</span><span class="pl-k">-</span>▶<span class="pl-en">console</span>.<span class="pl-c1">log</span>(chunk)
          <span class="pl-k">|</span>                           (end <span class="pl-k">of</span> msgListener)
◀<span class="pl-k">-</span>stdout<span class="pl-k">-</span>◀<span class="pl-k">|</span>
   (end <span class="pl-k">of</span> <span class="pl-c1">process</span>)</pre></div>

<h2>
<a id="read-more" class="anchor" href="#read-more" aria-hidden="true"><span class="octicon octicon-link"></span></a>Read more</h2>

<ul>
<li><a href="https://github.com/maboiteaspam/stream-messenger">https://github.com/maboiteaspam/stream-messenger</a></li>
<li><a href="https://github.com/maboiteaspam/stream-message-router">https://github.com/maboiteaspam/stream-message-router</a></li>
<li><a href="https://github.com/maboiteaspam/flower">https://github.com/maboiteaspam/flower</a></li>
<li><a href="https://github.com/maboiteaspam/bubbler">https://github.com/maboiteaspam/bubbler</a></li>
<li><a href="https://github.com/maboiteaspam/bubbled">https://github.com/maboiteaspam/bubbled</a></li>
<li><a href="https://github.com/maboiteaspam/event-stream-writer">https://github.com/maboiteaspam/event-stream-writer</a></li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/maboiteaspam">maboiteaspam</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
